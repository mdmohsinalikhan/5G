\documentclass[conference]{IEEEtran}

\usepackage[dvips]{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{flushend}

\begin{document}
\title{IMSI-based Routing in IPX and Identity Privacy in 5G}
\date{}%date stay empty

\author{
\IEEEauthorblockN{Mohsin Khan, Valtteri Niemi}
\IEEEauthorblockA{University of Helsinki \\ Helsinki, Finland \\ {mohsin.khan, valtteri.niemi}@helsinki.fi\\}
\and
\IEEEauthorblockN{Philip Ginzboorg}
\IEEEauthorblockA{Huawei Technologies \\ Helsini, Finland \\ philip.ginzboorg@huawei.com\\}}
\maketitle

\begin{abstract}
In 5G, identity privacy of a user is proposed to be protected by concealing the identifier of the user. In order to route the concealed identifier to the appropriate destination, certain information of about the IMSI - country code and network code need to be revealed. However, only recently, it is raised that when the destination is a virtual mobile network operator or a unified data management entity, the routing in IPX needs more information about the IMSI to be revealed. In this new context, we re-examine published alternative solutions of identity privacy. We find the previously promising solutions e.g., solution based on public key of home network become less promising. We find the solution based on identity based encryption becomes more promising than it was before.
\end{abstract}

\section{Introduction} \label{intro}
One major problem in the realm of identity privacy in mobile networks is to privatize the international mobile subscriber identity (IMSI). Serious effort has been put to solve this problem in the 3GPP community. Most of the solutions are based on some cryptographic techniques. Comparative analysis between the solutions have been published. There have been pros and cons in every solution. 
3GPP community is now at the verge of finalizing the specification for the first phase of 5G network. Idneity privacy is a major requirement in 5G. A solution based on public key cryptography is most likely going to be adopted privatize IMSI. Very recently a issue of routing the IMSIs in IPX has been raised. This routing issue weakens the effectiveness of this solution. Another issue around lawful interception (LI) has been noticed only recently.

In this paper we will do the comparative analysis in the light of these two new concerns. We will see that the balance of pros and cons between different solutions change significantly. The root-key based solution which appeared to be quite straightforward and effective solution becomes less effective and requires more implementation effort. On the other hand a solution based on identity based encryption which had its own cons, now nicely solve both of the concerns of IPX routing and LI. In this light we will argue that solution based on identity based encryption is the most effective and fairly straightforward solution to privatize IMSI.

In order to present a smooth discussion, first we need to explain some background. We will present an abstract view of a mobile network - we will use LTE. We will discuss how IMSI is used, how privacy of IMSI is vulnerable. We will also discuss the published solutions to some extent. Then we will explain the new concerns around IPX routing and LI. Then we will explain how the solution based on identity based encryption addresses the two concerns and how the other solutions suffer from them. We will see, these modifications in the analysis make the solution based on identity based encryption the most promising. Finally we conclude the paper appealing the 3GPP community to make a another consideration before finalizing the root key based solution.


\section{Background} \label{background}
\subsubsection{IMSI}
An IMSI is usually presented as a $15$ digit number but can be shorter. The first $3$ digits are the mobile country code (MCC), which are followed by the mobile network code (MNC), either $2$ digits or $3$ digits. The length of the MNC depends on the value of the MCC. The remaining digits are the mobile subscription identification number (MSIN) within the network's customer base \cite{TS23003}. 

Currently, when a user equipment (UE) tries to connect to a network for the first time, the UE has to identify itself using IMSI. Once the UE is identified, an authentication protocol is run in between the UE and the network. If the authentication protocol runs successfully, the network serves the UE with the services the UE is authorized to avail. In all the legacy networks this authentication protocol is a challenge-response based protocol. 


\subsubsection{Mobile Network}
A mobile network consists of the UE, SN and HN. Both of the SN and HN consist of radio access network (RAN) and core network (CN). The RAN of SN provides the connectivity in between UE and CN of SN. On the other hand, the CN of SN connects itself with the CN of HN via IPX. Note that in a non-roaming situation, the SN and HN are the same network. 

\subsubsection{IMSI Catchers}
There are two more entities which are not part of the network but relevant in our discussion, because they attack the network. They are passive IMSI catchers (PIC) and active IMSI catchers (AIC). The interface UE-SN is a logical interface in between UE and SN. This interface is initially unprotected. The logical interface SN-HN in between SN and HN is protected and the security of this interface is out of the scope of this paper. The PICs eavesdrop on the UE-RAN interface when it is unprotected to extract an IMSI. The AICs impersonate a legitimate SN and run a legitimate looking protocol with the UE in order to find out the IMSI. HN and UE both know the IMSI and they are trusted. Both of PIC and AIC are untrusted. 

%%\begin{figure}
%%\begin{center}
% Use the relevant command to insert your figure file.
% For example, with the graphicx package use
%%  \includegraphics[width=.98\textwidth]{security_architecture_abstraction.eps}
% figure caption is below the figure
%%\caption{High-level security architecture}
%%\label{fig:security_architecture_abstraction}       % Give a unique label
%%\end{center}
%%\end{figure}


\subsubsection{Solutions Against IMSI catchers}
One approach of protecting IMSI privacy is to use a temporary identifier instead of the actual IMSI and keep changing the temporary identifier at a feasible frequency. Note that the temporary identifier has to be assigned over a confidentiality protected channel and different entities of the network may assign different temporary identifiers to the UE. In the LTE network, the temporary identifier assigned by serving network (SN) is called globally unique temporary identity (GUTI) and the home network (HN) does not assign any temporary identifier to the UE. However, during the initial attachment of a UE to the SN, the UE has neither a GUTI nor a security context with the SN that can assign it with a GUTI. Besides, GUTI can be lost by either one or both of the UE and the SN. This would force the UE to reveal its IMSI to the SN to keep itself from permanently locked out of the network. This problem gives an opportunity to an active IMSI catcher (AIC) who impersonates a legitimate SN and forces the UE to run the initial attachment protocol. This also gives an opportunity to a passive IMSI catcher (PIC) to eavesdrop the IMSI sent in clear text. Solutions \cite{pseudonym_valtteri_philip, pseudonym_ericsson} have been proposed by using temporary IMSI known as pseudonym assigned by the HN. 

\section{Categories of Solutions}

In this report we present how a security context can be set up in between the network (either SN or HN) and the UE even before the identification of the UE so that the UE can use the security context to send its IMSI with confidentiality protection. Such a security context will mitigate the attack mounted by a PIC. In addition to this, we show that an AIC would not be able to agree on a legitimate security context with the UE and consequently will not be able to find out the IMSI.

We propose different solutions based on public-key encryption that make the UE-SN interface protected even during the initial attachment in order to fight against the PIC. Our solutions also stop the AIC from running a legitimate protocol successfully that could force the UE to reveal the IMSI. However, there are other 5G requirements which our solutions should also meet. Reduced signalling overhead, improved control plane latency are two such requirements. Concealing all the parts of IMSI, namely, MCC, MNC and MSIN has been identified as another requirement. Also, in the case of public-key, the complexity involved in setting a PKI and revocation of a public-key need to be considered with high importance. In some cases the public key of an entity is pre-provisioned to all the potential senders in the system. If this public key is revoked and a new public-private key pair is generated by the entity from which the public key was revoked, then the new public key needs to be re-provisioned to all those entities that were pre-provisioned with the old public key. Considering all these requirements, we evaluate our solutions based on the following criteria:
\begin{enumerate}
\item Concealed from PIC, AIC, SN
\item Parts of the IMSI concealed
\item Signalling overhead
\item Latency
\item PKI complexity
\item Public-key revocation and re-provisioning 
\end{enumerate}

We also want to see if any of these solutions would work in a heterogeneous situation where one or more of the entities involved would come from the legacy networks. Apparently, none of the legacy networks use public-key encryption. On the other hand, all of the solutions presented in this report use public-key encryption. Therefore, it can be said that none of the solutions presented in this report will work in such a heterogeneous situation. While the choice of the solution is dependent on how much we want to achieve, hybrid solution using identity based public-key encryption and pseudonyms appear to be a promising approach.

In Section \ref{sec:id_based_crypto} we present a quick introduction to the different kinds of public-key encryption we have used in this report. In Section \ref{sec:solutions} we present the solutions based on different kinds of public-key encryption. In Section \ref{sec:evaluation}, we present an evaluation of the presented solutions based on the aforementioned evaluation criteria. Finally we conclude the paper in Section \ref{sec:conclusion}.


For publication in the section Full Paper, beginning with the Proceedings of FRUCT14, article must be at least 6 pages and no more than 12 pages. Abstracts for performances may be from 1 to 3 pages. Exceeding these volumes is only possible by prior agreement with the organizers of the conference.

In \TeX for program listing is using command $\setminus$\ttfamily ttfamily.

\rmfamily
If you would like to make a cite, place it at the end of sentence before point or comma.

\subsection{Information about authors}
Please place last name after first name, declare them completely. If all the authors work in one place, their names are written with a comma (after last's no comma) in a single column. So a number of columns are equal to number of authors working in different places. Following declare author's place of work (at new line, no comma in the end). Place of work it's only general name of company or university, without name of particular department. On the new line place city and country by comma, and on the last line -- email (without word ``Email'', don't use hyperlinks). The sequence of authors -- at your discretion. The order of publication in Proceedings is defined by the first author. Your can see different ways to design information about authors at Fig. \ref{fig1}.

\begin{figure}[h]
	\centering
	\includegraphics{Fig1}
	\caption{Different ways to design information about authors}
	\label{fig1}
\end{figure}

\section{Main part (Heading 1)}

\subsection{Structural components (Heading 2)}

\subsubsection{Introduction (Heading 3)}
The introduction it is a place for description of the problem, analysis of existing solutions (with links to sources), their disadvantages and  advantages of your approach. Clear statement of the work purpose is required.  

\subsubsection{Main part}
The main part is recommended to be divided into sections. The section titles should have meaningful names. The name ''Main part'' is not allowed.

\subsubsection{Lists}
There are two types of lists: bulleted and numbered. In numbered list use right bracket after number. 

%\begin{enumerate}
%	\item 
%\end{enumerate}

In bulleted list as a marker is using bullet. 

%\begin{itemize}
%	\item 
%\end{itemize}

If you start item from first word capitalized place at the end point, if not -- comma (or semicolon if in text of item comma have been used). At the end of last item place point.

\subsubsection{Equations}
Equations are numbered only if they are referenced in the text. 
\begin{equation}
	a-b=c
	\label{eq:1}
\end{equation}
where $a$ is main symbol, $b$ -- principal and $c$ -- basic.

Italicize Roman symbols for quantities and variables, but not Greek symbols. Use a long dash rather than a hyphen for a minus sign. Be sure that the symbols in your equation have been defined before or immediately following the equation.

Don't forget to use the same style for defining symbols in the text as in equation.

\subsubsection{Algorithms}
If you want to lead the algorithm, design it so Algorithm \ref{alg:algorithm}.

\begin{algorithm}
  \caption{Your algorithm}\label{alg:algorithm}
  \begin{algorithmic}
 
 \item Here will be the text of your algorithm. Make \textbf{operators} bold, variables \textit{italic}. step 1;
 \item step 2;
  \end{algorithmic}
\end{algorithm}

\section{Figures and tables}
Place figures and tables at the top and bottom of  page. Large figures and tables may span for all page. Them can be rotated if it is necessary. Each figure or table should be caption. Insert figures and tables after they are cited in the text. Use words rather than symbols or abbreviations when writing labels to avoid confusing the reader. Don't place point at the end of captions for figures or tables. 

\subsection{Figures}
Use the abbreviation ``Fig. 1'' in text. Use black and white colors, example of bad black and white graphics -- Fig. \ref{fig2}. Don't forget to attach to the source separate files with figures. Format EPS is mandatory for TeX source.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.45\textwidth]{Fig2}
	\caption{Red, blue and green line}
	\label{fig2}
\end{figure}

\subsection{Tables}

\begin{table}[h]
\centering
\label{tab1}
\caption{Popular drawbacks for submissions of FRUCT13}\label{tab1}\vspace{4pt}
\begin{tabular}{|c|c|c|c|}

		\hline
 		\textbf{Drawbacks in} & \textbf{Number of submissions} \\
 		\hline
		Paper Title & 7 \\
		\hline
		Information about authors & 10 \\
		\hline
		Abstract & 2 \\
		\hline
		Index Terms & 11 \\
		\hline
		Title of sections & 9 \\
		\hline
		General text & 10 \\
		\hline
		Figures and tables & 15 \\
		\hline
		Lists & 4 \\
		\hline
		References & 13 \\
		\hline
		Design do not match our template & 7 \\
		\hline
		In total & 40 \\
		\hline
\end{tabular}
\end{table}

\section{Design of references}

The template number citations consecutively within brackets \cite{Cover}. Numbering references depending on the order of their appearance in the text. The sentence punctuation follows the bracket \cite{Dobrushin}. Refer simply to the reference number, as in \cite{Blachman} -— do not use ``Ref. \cite{Blachman}'' or ``reference \cite{Blachman}'' except at the beginning of a sentence: ``Reference \cite{Blachman} was the first ...''

Unless there are six authors or more give all authors names; do not use ``et al.''. Papers that have not been published, even if they have been submitted for publication, should be cited as ``unpublished'' \cite{Elissa}. Papers that have been accepted for publication should be cited as ``in press'' \cite{Nicole}. Capitalize only the first word in a paper title, except for proper nouns and element symbols.

References must be design as a list. Use 9 point Times New Roman for References. In references there are two type of indent. First for references numbered from 1 to 9~-- indent from the left margin equal 0,4 cm and hanging indent for first line equal 0,6 cm. For all other~-- indent from the left margin equal 0,25 cm and hanging indent for first line equal 0,75 cm.

If you use \TeX, please, make references as in template in main file of \TeX  source. 

Requirements for formatting references are various depending on its type:
\begin{enumerate}
	\item Books
	
		\begin{itemize}
			\item Initials and family name of each authors by comma (at last use ``and'').
			\item Comma, \textit{name of book without quotes (italic)}, point at the end.
			\item Then all other bibliographic information by comma (publisher, year, page), point at the end.
		\end{itemize}	
		
		As example \cite{Cover}.
 	\item Articles
 
 		\begin{itemize}
			\item Initials and family name of each authors by comma.
			\item Comma, name of article in quotes, \textit{name of the journal or conference (italic)}.
			\item Then all other bibliographic information by comma (publisher, year, page), point at the end.
		\end{itemize}	
		
		Examples for article references in \cite{Dobrushin, Blachman}.
	\item Internet resources
	
 		\begin{itemize}
			\item Initials and family name of each authors by comma.
			\item Comma, name of intertet resource and other bibliographic information by comma (if exists).
			\item “Web:” and web link (not hyperlink), point at the end.
		\end{itemize}	
		
		Example -- \cite{IEEE}.
\end{enumerate}

\section{Conclusion}
This part presents the key findings in substance. Avoid simple enumeration of the following material. It is desirable to provide a link to existing articles and grants. 

\section*{Acknowledgment}
This section is not numbered. You may wish to express gratitude here.

\begin{thebibliography}{6}

\bibitem{NGMN_white_paper} NGMN 5G White Paper V1.0 [cited Jan, 2017]. Available at: https://www.ngmn.org/uploads/media/\\NGMN\_5G\_White\_Paper\_V1\_0.pdf

\bibitem{TR33899} 3GPP TR 33.899 V0.6.0 [cited Jan, 2017]. Available at: https://portal.3gpp.org/desktopmodules/Specifications/\\SpecificationDetails.aspx?specificationId=3045

\bibitem{TS23003} 3GPP TS 23.003 V14.2.0 [cited Jan, 2017]. Available at: https://portal.3gpp.org/desktopmodules/Specifications/\\SpecificationDetails.aspx?specificationId=729

\bibitem{TR21905} 3GPP TR 21.905 [cited Jan, 2017]. Available at: https://portal.3gpp.org/desktopmodules/Specifications/\\SpecificationDetails.aspx?specificationId=558


\bibitem{pseudonym_ericsson} Karl Norrman, Mats N\"aslund, Elena Dubrova: Protecting IMSI and User Privacy in 5G Networks. 2nd International Workshop on 5G Security

\bibitem{pseudonym_valtteri_philip} Philip Ginzboorg,  Valtteri Niemi: Privacy of the long-term identities in cellular networks. Proceedings of the 9th EAI International Conference on Mobile Multimedia Communications
Pages 167-175


\bibitem{Cover}
\textit{(Example for books)} T.M.Cover and J.A. Thomas, \emph{Elements of Information Theory}. New York: Wiley, 1991.

\bibitem{Dobrushin}
\textit{(Example for articles)} R.L. Dobrushin, ``Optimum information transmission through a channel with unknown parameters'',  \emph{Radiotech.Electron.}, vol.4, Dec.1959, pp. 1951-1956.

\bibitem{Blachman}
\textit{(Example for articles)} N.M. Blachman, ``Communication as a game'', \emph{in Proc. WESCON Conf.}, Aug. 1957, pp. 61-66.

\bibitem{IEEE}
\textit{(Example for web-links)} IEEE official website, Manuscript Templates for Conference Proceedings, Web: http://www.ieee.org/conferences\_events/conferences/publishing/templates.\newline html.

\bibitem{Elissa}
\textit{(Example for unpublished references)} K. Elissa, ``Title of paper if known'', unpublished.

\bibitem{Nicole}
\textit{(Example for references have been accepted for publication)} R. Nicole, ``Title of paper with only first word capitalized'', J. Name Stand. Abbrev., in press.

\end{thebibliography}

\end{document}